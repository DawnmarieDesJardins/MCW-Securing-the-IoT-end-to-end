![](https://github.com/Microsoft/MCW-Template-Cloud-Workshop/raw/master/Media/ms-cloud-workshop.png "Microsoft Cloud Workshops")

<div class="MCWHeader1">
Securing the IoT end to end
</div>

<div class="MCWHeader2">
Whiteboard design session trainer guide
</div>

<div class="MCWHeader3">
June 2019
</div>


Information in this document, including URL and other Internet Web site references, is subject to change without notice. Unless otherwise noted, the example companies, organizations, products, domain names, e-mail addresses, logos, people, places, and events depicted herein are fictitious, and no association with any real company, organization, product, domain name, e-mail address, logo, person, place or event is intended or should be inferred. Complying with all applicable copyright laws is the responsibility of the user. Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation.

Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.

The names of manufacturers, products, or URLs are provided for informational purposes only and Microsoft makes no representations and warranties, either expressed, implied, or statutory, regarding these manufacturers or the use of the products with any Microsoft technologies. The inclusion of a manufacturer or product does not imply endorsement of Microsoft of the manufacturer or product. Links may be provided to third party sites. Such sites are not under the control of Microsoft and Microsoft is not responsible for the contents of any linked site or any link contained in a linked site, or any changes or updates to such sites. Microsoft is not responsible for webcasting or any other form of transmission received from any linked site. Microsoft is providing these links to you only as a convenience, and the inclusion of any link does not imply endorsement of Microsoft of the site or the products contained therein.

© 2019 Microsoft Corporation. All rights reserved.

Microsoft and the trademarks listed at <https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/Usage/General.aspx> are trademarks of the Microsoft group of companies. All other trademarks are property of their respective owners.

**Contents**

<!-- TOC -->

- [Trainer information](#trainer-information)
    - [Role of the trainer](#role-of-the-trainer)
    - [Whiteboard design session flow](#whiteboard-design-session-flow)
    - [Before the whiteboard design session: How to prepare](#before-the-whiteboard-design-session-how-to-prepare)
    - [During the whiteboard design session: Tips for an effective whiteboard design session](#during-the-whiteboard-design-session-tips-for-an-effective-whiteboard-design-session)
- [Securing the IoT end to end whiteboard design session student guide](#securing-the-iot-end-to-end-whiteboard-design-session-student-guide)
    - [Abstract and learning objectives](#abstract-and-learning-objectives)
    - [Step 1: Review the customer case study](#step-1-review-the-customer-case-study)
        - [Customer situation](#customer-situation)
        - [Customer needs](#customer-needs)
        - [Customer objections](#customer-objections)
        - [Infographic for common scenarios](#infographic-for-common-scenarios)
    - [Step 2: Design a proof of concept solution](#step-2-design-a-proof-of-concept-solution)
    - [Step 3: Present the solution](#step-3-present-the-solution)
    - [Wrap-up](#wrap-up)
    - [Additional references](#additional-references)
- [Securing the IoT end to end whiteboard design session trainer guide](#securing-the-iot-end-to-end-whiteboard-design-session-trainer-guide)
    - [Step 1: Review the customer case study](#step-1-review-the-customer-case-study-1)
    - [Step 2: Design a proof of concept solution](#step-2-design-a-proof-of-concept-solution-1)
    - [Step 3: Present the solution](#step-3-present-the-solution-1)
    - [Wrap-up](#wrap-up-1)
    - [Preferred target audience](#preferred-target-audience)
    - [Preferred solution](#preferred-solution)
    - [Checklist of preferred objection handling](#checklist-of-preferred-objection-handling)
    - [Customer quote (to be read back to the attendees at the end)](#customer-quote-to-be-read-back-to-the-attendees-at-the-end)

<!-- /TOC -->

# Trainer information

Thank you for taking time to support the whiteboard design sessions as a trainer!

## Role of the trainer

An amazing trainer:

-   Creates a safe environment in which learning can take place.

-   Stimulates the participant's thinking.

-   Involves the participant in the learning process.

-   Manages the learning process (on time, on topic, and adjusting to benefit participants).

-   Ensures individual participant accountability.

-   Ties it all together for the participant.

-   Provides insight and experience to the learning process.

-   Effectively leads the whiteboard design session discussion.

-   Monitors quality and appropriateness of participant deliverables.

-   Effectively leads the feedback process.

## Whiteboard design session flow 

Each whiteboard design session uses the following flow:

**Step 1: Review the customer case study (15 minutes)**

**Outcome**

Analyze your customer's needs.

-   Customer's background, situation, needs and technical requirements

-   Current customer infrastructure and architecture

-   Potential issues, objectives and blockers

**Step 2: Design a proof of concept solution (60 minutes)**

**Outcome**

Design a solution and prepare to present the solution to the target customer audience in a 15-minute chalk-talk format.

-   Determine your target customer audience.

-   Determine customer's business needs to address your solution.

-   Design and diagram your solution.

-   Prepare to present your solution.

**Step 3: Present the solution (30 minutes)**

**Outcome**

Present solution to your customer:

-   Present solution

-   Respond to customer objections

-   Receive feedback

**Wrap-up (15 minutes)**

-   Review preferred solution

## Before the whiteboard design session: How to prepare

Before conducting your first whiteboard design session:

-   Read the Student guide (including the case study) and Trainer guide.

-   Become familiar with all key points and activities.

-   Plan the point you want to stress, which questions you want to drive, transitions, and be ready to answer questions.

-   Prior to the whiteboard design session, discuss the case study to pick up more ideas.

-   Make notes for later.

## During the whiteboard design session: Tips for an effective whiteboard design session

**Refer to the Trainer guide** to stay on track and observe the timings.

**Do not expect to memorize every detail** of the whiteboard design session.

When participants are doing activities, you can **look ahead to refresh your memory**.

-   **Adjust activity and whiteboard design session pace** as needed to allow time for presenting, feedback, and sharing.

-   **Add examples, points, and stories** from your own experience. Think about stories you can share that help you make your points clearly and effectively.

-   **Consider creating a "parking lot"** to record issues or questions raised that are outside the scope of the whiteboard design session or can be answered later. Decide how you will address these issues, so you can acknowledge them without being derailed by them.

***Have fun**! Encourage participants to have fun and share!*

**Involve your participants.** Talk and share your knowledge but always involve your participants, even while you are the one speaking.

**Ask questions** and get them to share to fully involve your group in the learning process.

**Ask first**, whenever possible. Before launching into a topic, learn your audience's opinions about it and experiences with it. Asking first enables you to assess their level of knowledge and experience, and leaves them more open to what you are presenting.

**Wait for responses**. If you ask a question such as, "What's your experience with (fill in the blank)?" then wait. Do not be afraid of a little silence. If you leap into the silence, your participants will feel you are not serious about involving them and will become passive. Give participants a chance to think, and if no one answers, patiently ask again. You will usually get a response.

#  Securing the IoT end to end whiteboard design session student guide

## Abstract and learning objectives 

In this whiteboard design session, you will work with a group to design an end-to-end solution that leverages Microsoft Azure's IoT features, tools and resources to secure and monitor a set of IoT devices.

At the end of this session, you will be better able to design and recommend solutions that help organizations properly secure and monitor their IoT-based infrastructure.

## Step 1: Review the customer case study 

**Outcome**

Analyze your customer's needs.

Timeframe: 15 minutes

Directions:  With all participants in the session, the facilitator/SME presents an overview of the customer case study along with technical tips.

1.  Meet your table participants and trainer.

2.  Read all of the directions for steps 1-3 in the student guide.

3.  As a table team, review the following customer case study.

### Customer situation

Contoso, Ltd. has major holdings in one of the world’s most important oil-producing regions. To overcome the challenges of monitoring and optimizing a vast number of widely dispersed field assets, Contoso, Ltd. is looking to streamline its operations with IoT solutions. They want to deploy IoT technologies to electronically collect data and use cloud based solutions to store and analyze it in order to gain new insights into well operations and future drilling possibilities. 

Their environments are very tough environments in which to work. The climate is hot, harsh, and unforgiving, and oil wells are often spaced many miles apart, so field technicians can spend much of their day just driving from one to another. Cellular and radio reception is spotty at best, so collecting data about well conditions and performance typically involves manually writing down information. The technician must then make the long trek to the central office at the end of the day to upload the data for analysis. With such remote situations, a key concern for Contoso is not only how they manage these remote devices, but more broadly how they secure the complete solution that encompasses the physical device, the software on the device, the services processing the data in the cloud and the network connecting it all. 

Contoso plans to tie in to existing sensors at the well head that monitor key system parameters like temperatures, pressures, and flow rates. They will deploy gateway devices route device data for processing, storage and analytics. Internal IT staff and engineers want to visualize the high-resolution data and deliver near real-time analyses. The company is placing a premium on flexibility and ease of use, with security as a fundamental. 

In addition, they would also like see the solution yield benefits to their workers in the field. “The field technicians and lease operators already have tools on their phones that they use every day to see what a well is doing,” explains Miles Strom. “Our goal is to connect these tools to live data from the IoT sensors. So, instead of seeing low-resolution volumes or flow rates, they’ll see what is happening in real time. This way they can respond immediately to problems that lead to downtime or maintenance issues.”

They have implemented a proof of concept solution for collecting and analyzing device telemetry using IoT Hub, but are interested in learning about any related services in Azure that would help them to secure such solutions. 

### Customer needs 

1.  Ensure that all IoT devices are properly registered and assigned a secure tamperproof identity.

2.  Ensure devices are operating within assigned policy standards and are not tampered with.

3.  Enable an alerting solution with little to no effort configuration that will notify and allow for remediation in the case of fault or malicious activity.

4.  Ensure all events are surfaced in one place for simplicity.

5.  Address the need to have auditing and monitoring across a wide range of device operating systems and processor architectures (Linux, x86, x64, etc).

6.  Automate the security agent provisioning rather than having to physically or remotely "touch" all the devices.

7.  Ensure only the most secure protocols are implemented and used during any transmissions

8.  Ensure that in the future it will be possible to have an enterprise-wide look at any vulnerabilities or malicious events, not just specifically focused the IoT infrastructure.

### Customer objections 

1.  Contoso, Ltd staff are worried it may be impossible to manage the many thousands of IoT devices they have deployed around the world with any one product.

2.  Can Azure handle all the different types of operating systems and processor architectures of their devices?

3.  Will they be able to monitor for specific events on some of their proprietary devices?

4.  Can Azure support non-TPM hardware devices?

5.  Will the communications from a device to Azure be secure enough?

6.  Can an Azure logging solution handle the massive amount of events and alerts that will need to be ingested?

7.  Is it possible to assign role-based permissions based on their security objectives and policies to the IoT resources such as the Hub, Edge and individual devices? 

8.  Is the solution capable of being flexible in the types of reporting and alerts that can be generated based on custom logging event data?

9.  Will we be able to limit the messages and network traffic to specific network IP addresses/subnets for our devices?


### Infographic for common scenarios

![Envisioned situation](../Media/envisioned-situation.png)

## Step 2: Design a proof of concept solution

**Outcome**

Design a solution and prepare to present the solution to the target customer audience in a 15-minute chalk-talk format.

Timeframe: 60 minutes

**Business needs**

Directions: With all participants at your table, answer the following questions and list the answers on a flip chart:

1.  Who should you present this solution to? Who is your target customer audience? Who are the decision makers?

2.  What customer business needs do you need to address with your solution?

**Design**

Directions: With all participants at your table, respond to the following questions on a flip chart:

*High-level architecture*

Without getting into the details (the following sections will address the details), diagram your initial vision for handling the top-level requirements.

Briefly sketch-out and propose a high-level solution that meets the customer's business and technical needs and mitigates their objections. For this workshop, you may choose from the following technologies (you may not need all of them in the correct solution):

1.  IoT Hub and Provisioning Service

2.  Azure Networks and Network Security Groups

3.  Virtual Private Networks (Point to Point, Site to Site) and Express Route

4.  Azure Web Apps

5.  Azure Log Analytics

6.  Azure Security Center

7.  Azure Sentinel

8.  Azure Active Directory

*Azure Security*

Describe how you will utilize Azure security features to secure the various resources such as the following:

1.  How will you secure the IoT Hub?

2.  How will you secure the IoT Provisioning Service?

*Device Security*

Describe how you will secure the following:

1.  How will you secure the IoT Edge Devices?

2.  How will you secure the IoT Devices?

*Ensuring auditing and compliance*

Describe how you will use Azure features to ensure the following:

1.  How will you monitor and audit device access?

2.  How will you monitor and audit network traffic across Virtual Networks?

3.  How will you monitor and audit Azure resource changes?

4.  Create custom alerts and execute remediation and investigation activities on detection?

5.  What tools would you setup to surface audit and compliance reporting to IT Executives?

**Prepare**

Directions: With all participants at your table:

1.  Identify any customer needs that are not addressed with the proposed solution.

2.  Identify the benefits of your solution.

3.  Determine how you will respond to the customer's objections.

Prepare a 15-minute chalk-talk style presentation to the customer.

## Step 3: Present the solution

**Outcome**

Present a solution to the target customer audience in a 15-minute chalk-talk format.

Timeframe: 30 minutes

**Presentation**

Directions:

1.  Pair with another table.

2.  One table is the Microsoft team and the other table is the customer.

3.  The Microsoft team presents their proposed solution to the customer.

4.  The customer makes one of the objections from the list of objections.

5.  The Microsoft team responds to the objection.

6.  The customer team gives feedback to the Microsoft team.

7.  Tables switch roles and repeat Steps 2-6.

##  Wrap-up 

Timeframe: 15 minutes

Directions: Tables reconvene with the larger group to hear the facilitator/SME share the preferred solution for the case study.

##  Additional references

|    |            |
|----------|:-------------:|
| **Description** | **Links** |
| Azure IoT Hub   | https://docs.microsoft.com/en-us/azure/iot-hub/  |
| Azure IoT Edge   | https://docs.microsoft.com/en-us/azure/iot-edge/  |
| Azure IoT Device Provisioning Service   | https://docs.microsoft.com/en-us/azure/iot-dps/  |
| Azure IoT Edge Security Manager  |  https://docs.microsoft.com/en-us/azure/iot-edge/iot-edge-security-manager|
| Azure Security Center for IoT  | https://docs.microsoft.com/en-us/azure/asc-for-iot/overview  |
| Azure IoT SDK  | https://github.com/Azure/azure-iot-sdks  |
| Azure IoT Security Agent  | https://github.com/Azure/Azure-IoT-Security-Agent-C  |
| Azure Sentinel   | <https://docs.microsoft.com/en-us/azure/sentinel/>   |
| Azure Policy   | <https://azure.microsoft.com/en-us/services/azure-policy/>   |
| Compliance Commitments   |  <http://azure.microsoft.com/en-us/support/trust-center/services/>  |
| Azure Trust Center  | <http://azure.microsoft.com/en-us/support/trust-center/>     |


# Security the IoT end to end whiteboard design session trainer guide

## Step 1: Review the customer case study

-   Check in with your table participants to introduce yourself as the trainer.

-   Ask, "What questions do you have about the customer case study?"

-   Briefly review the steps and timeframes of the whiteboard design session.

-   Ready, set, go! Let the table participants begin.

## Step 2: Design a proof of concept solution

-   Check in with your tables to ensure that they are transitioning from step to step on time.

-   Provide some feedback on their responses to the business needs and design.

    -   Try asking questions first that will lead the participants to discover the answers on their own.

-   Provide feedback for their responses to the customer's objections.

    -   Try asking questions first that will lead the participants to discover the answers on their own.

## Step 3: Present the solution

-   Determine which table will be paired with your table before Step 3 begins.

-   For the first round, assign one table as the presenting team and the other table as the customer.

-   Have the presenting team present their solution to the customer team.

    -   Have the customer team provide one objection for the presenting team to respond to.

    -   The presentation, objections, and feedback should take no longer than 15 minutes.

    -   If needed, the trainer may also provide feedback.

## Wrap-up

-   Have the table participants reconvene with the larger session group to hear the facilitator/SME share the following preferred solution.

##  Preferred target audience

-  IoT Developers and Support
-  Cloud Architects
-  Infrastructure Managers
-  Network Engineers

## Preferred solution

*High-level architecture*

Without getting into the details (the following sections will address the details), diagram your initial vision for handling the top-level requirements.

Briefly sketch-out and propose a high-level solution that meets the customer's business and technical needs and mitigates their objections. For this workshop, you may choose from the following technologies (you may not need all of them in the correct solution):

1.  IoT Hub and Provisioning Service

2.  Azure Networks and Network Security Groups

3.  Virtual Private Networks (Point to Point, Site to Site) and Express Route

4.  Azure Web Apps

5.  Azure Log Analytics

6.  Azure Security Center

7.  Azure Sentinel

8.  Azure Active Directory

*Azure Security*

Describe how you will utilize Azure security features to secure the various resources such as the following:

1.  How will you secure the IoT Hub?

2.  How will you secure the IoT Provisioning Service?

*Device Security*

Describe how you will secure the following:

1.  How will you secure the IoT Edge Devices?

2.  How will you secure the IoT Devices?

*Ensuring auditing and compliance*

Describe how you will use Azure features to ensure the following:

1.  How will you monitor and audit device access?

2.  How will you monitor and audit network traffic across Virtual Networks?

3.  How will you monitor and audit Azure resource changes?

4.  Create custom alerts and execute remediation and investigation activities on detection?

5.  What tools would you setup to surface audit and compliance reporting to IT Executives?

## Checklist of preferred objection handling

1.  Contoso, Ltd staff are worried it may be impossible to manage the many thousands of IoT devices they have deployed around the world with any one product.

-   Utilizing the Azure IoT Hub Device Provisioning Service, Contoso can enable a zero-touch, just-in-time provisioning to specific IoT hubs without any human intervention.  The service scales to many millions of devices in a secure and scalable manner that will meet Contoso's needs.

2.  Can Azure handle all the different types of operating systems and processor architectures of their devices?

-   The Azure IoT Agents have been release with ANSI-C standards in mind.  The code is freely available on GitHub along with an entire SDK that will enable Contoso to easily re-compile the source for any target device.

3.  Will they be able to monitor for specific events on some of their propriatary devices?

-   Yes, they can monitor for custom events on their propriatary devices using the Azure IoT SDK to send message and events to their specific IoT Hub(s).

4.  Can Azure support non-TPM hardware devices?

-   Yes, you can recompile the source code to utilize simulated/software TPMs, however this is not a standard or accepted way of doing secure device management in production environments.

5.  Will the communications from a device to Azure be secure enough?

-   Absoultely, the Azure IoT SDKs come with support for several different protocols including the latest HTTPS and SSL features.

6.  Can an Azure logging solution handle the massive amount of events and alerts that will need to be ingested?

-   Yes, at the lowest plan level, you can send 500MB of data to a Log Analytics workspace.  Standard and Premium plans have no limit on the amount of data uploaded even if it is terabytes per day.

7.  Is it possible to assign role-based permissions based on their security objectives and policies to the IoT resources such as the Hub, Edge and individual devices? 

-   Yes, Azure IoT resources come with a management plane that gives you flexiblity to allow various levels of permissions to target specific roles of your IoT Infrastructure.

8.  Is the solution capable of being flexible in the types of reporting and alerts that can be generated based on custom logging event data?

-   Yes, you can choose to utilize the out of box alert templates, or create your own templates based on common Azure and Operating System events, or even your own custom events.

9.  Will we be able to limit the messages and network traffic to specific network IP addresses/subnets for our devices?
 
 -   Yes, you can enable IP Filtering in the IoT Hub to ensure that only messages that originate from specific IPs or subnet are allowed to flow through to the IoT Hub(s).

## Customer quote (to be read back to the attendees at the end)

"Managing our massive worldwide IoT Infrastructure using the latest security features of Azure has given us the confidence to know our devices are running securly and efficiently with the added flexiblity to change our direction at any time." 

Jack Tradewinds, CIO of Contoso, Ltd.